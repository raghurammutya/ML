[pytest]
# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Test paths
testpaths = tests

# Asyncio mode
asyncio_mode = auto

# Output options
addopts =
    # Verbose output
    -v

    # Show local variables in tracebacks
    -l

    # Show summary of all test outcomes
    -ra

    # Coverage options
    --cov=app
    --cov-report=html
    --cov-report=term-missing
    --cov-report=xml

    # Fail if coverage below threshold
    --cov-fail-under=40

    # Show warnings
    -W default

    # Strict markers (fail on unknown markers)
    --strict-markers

    # Show durations of slowest tests
    --durations=10

# Markers for organizing tests
markers =
    unit: Unit tests (fast, isolated)
    integration: Integration tests (slower, require database)
    slow: Slow tests (>1 second)
    performance: Performance and query optimization tests
    security: Security-focused tests
    critical: Critical path tests that must pass
    database: Tests that require database connection
    redis: Tests that require Redis connection
    websocket: WebSocket-related tests
    api: API endpoint tests

# Ignore warnings from dependencies
filterwarnings =
    ignore::DeprecationWarning:pydantic.*
    ignore::DeprecationWarning:pytz.*

# Minimum Python version
minversion = 3.11

# Require pytest plugins
required_plugins = pytest-asyncio pytest-cov
